<!doctype html>
<html>
<head>
  <title>Diets</title>
  <link rel="icon" type="image/png" href="/favicon.png">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<div class="container py-4">

  <div class="d-flex justify-content-between mb-4">
    <h1>Diets</h1>
    <a href="/admin/diets/create" class="btn btn-success">+ Create Diet</a>
  </div>

  <table class="table table-bordered bg-white">
    <thead class="table-dark">
      <tr>
        <th>Title</th>
        <th>Created By</th>
        <th>Assigned To</th>
        <th>Calories</th>
        <th style="width:160px">Action</th>
      </tr>
    </thead>

    <tbody>
      <% diets.forEach(d => { %>
        <tr>
          <td><%= d.title %></td>

          <td>
            <%= d.createdBy ? d.createdBy.name : "Unknown" %>
            (<%= d.createdBy.role %>)
          </td>

          <td>
            <%= d.assignedTo ? d.assignedTo.name : "Not Assigned" %>
          </td>

          <td><%= d.calories %> kcal</td>

          <td>
            <a href="/admin/diets/<%= d._id %>/edit" class="btn btn-sm btn-primary">Edit</a>

            <form action="/admin/diets/<%= d._id %>/delete" method="POST" style="display:inline;">
              <button class="btn btn-sm btn-danger" onclick="return confirm('Delete diet?')">Delete</button>
            </form>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>

  <a href="/admin/dashboard" class="btn btn-secondary mt-3">Back to Dashboard</a>

</div>

</body>
</html>
